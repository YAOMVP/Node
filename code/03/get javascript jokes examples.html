<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>get</title>
</head>

<body>
    <button class="get1">GET jokes using alert</button>
    <button class="get2">GET jokes using console log</button>
</body>

<script>
    let getFirst = document.querySelector(".get1");
    let getSecond = document.querySelector(".get2");
    //ğŸ˜ŠğŸ˜ŠğŸ˜ŠæŠŠåŸç”Ÿä»£ç è¿›è¡Œå°è£…ï¼šå‘èµ·getè¯·æ±‚
    //ğŸ˜Šå°è£…å‡½æ•°æ€æƒ³ï¼šæŠŠç›¸åŒçš„ä»£ç å°è£…åœ¨ä¸€èµ·ï¼Œä¸åŒçš„ä»£ç å˜æˆå‚æ•°
    // å‚æ•°1ï¼šurlä¸åŒ   option.url
    //å‚æ•°2ï¼šdata æ¥å£å‚æ•°(ä¸ä¸€å®šæœ‰ ï¼Ÿnum = 0)   option.data
    //å‚æ•°3ï¼šsuccess æˆåŠŸä¹‹åçš„å›è°ƒå‡½æ•°    option.success
    /*ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ğŸ”å¥—è·¯ğŸ”ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼  
    å¦‚æœå‚æ•°è¶…è¿‡ä¸¤ä¸ª å°†æ‰€æœ‰çš„å‚æ•°æ”¾åœ¨ğŸ”å¯¹è±¡ğŸ”ä¸­ optionï¼ï¼ï¼ï¼ï¼ï¼
    */

    function get(option) { //ğŸ˜Šæ˜¯ä¸ªå¯¹è±¡   
        //ä¹‹å‰åˆ†å¼€å†™çš„ï¼šurl, data, success  ç°åœ¨ç›´æ¥å†™ï¼šoption å°±æ˜¯ç›´æ¥æŠŠå¯¹è±¡ä¼ è¿›æ¥
        //1.ğŸ“—ä¸€æ · å£°æ˜ç½‘ç»œè¯·æ±‚ï¼š
        let xhr = new XMLHttpRequest();

        //2.ğŸ“•ä¸ä¸€æ · è®¾ç½®openæ–¹æ³• 
        /* xhr.open("get",url) ğŸ˜Šè¦åˆ¤æ–­æ˜¯å¦æœ‰å‚æ•°çš„æ‹¼æ¥,å¦‚æœæœ‰è¦åœ¨urlçš„åè¾¹è¿›è¡Œä¸€ä¸ª
        ?num=10æ‹¼æ¥ */
        if (option.data) { //ğŸ˜Šçœ‹çœ‹urlåè¾¹æœ‰æ²¡æœ‰dataï¼Œå¦‚æœæœ‰æ‰è¿›çš„æ¥
            // ä¼ è¿›æ¥çš„å°±æ˜¯?num=10
            option.url += `?${option.data}`;
        }
        xhr.open("get", option.url);

        //3.ğŸ“•ä¸ä¸€æ ·onloadå›è°ƒå‡½æ•°
        xhr.onload = function() {
            //ğŸ˜Šè¯·æ±‚çš„ç›®çš„æ˜¯ä¸ºäº†è·å¾—åå°å“åº”çš„æ•°æ®ï¼ï¼ï¼ï¼  è¿™æ˜¯è°ƒç”¨äº†å£°æ˜çš„å‡½æ•°ï¼ï¼ï¼
            option.success(xhr.response); //ğŸ˜Šé‡Œè¾¹å†™äº†ä»€ä¹ˆå°±å¹²ä»€ä¹ˆ  æŠŠxhr.responseæ‹¿åˆ°ï¼Œç»™åˆ°successå›è°ƒå‡½æ•° ï¼ï¼ï¼ğŸ˜Šå®å‚
        }

        //5.ğŸ“—ä¸€æ · å‘èµ·sendæ–¹æ³•å¼€å§‹è¯·æ±‚ï¼š
        xhr.send();
    }

    //ğŸ˜Šè°ƒç”¨getæ–¹æ³•  è·å¾—ä¸€æ¡å¼¹çª—ç¬‘è¯
    getFirst.addEventListener("click", function() {
        get({
            url: "https://autumnfish.cn/api/joke",
            data: "",
            success: function(backData) {
                alert(backData);
            }
        })
    });

    //ğŸ˜Šè°ƒç”¨getæ–¹æ³• è·å¾—å¤šæ¡ç¬‘è¯ï¼Œconsol logæ˜¾ç¤º
    getSecond.addEventListener("click", function() {
        get({
            url: "https://autumnfish.cn/api/joke/list",
            data: "num=10",
            success: function(backData) {
                console.log(JSON.parse(backData)); //ä¼ å›æ¥çš„æ˜¯JSONæ ¼å¼çš„ï¼Œè¦è½¬æ¢
            }
        })
    });
</script>

</html>